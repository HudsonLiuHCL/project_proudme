'use strict';

const get = require('../get');
const mpath = require('mpath');
const parseProjection = require('../projection/parseProjection');

/*!
 * ignore
 */

module.exports = function removeDeselectedForeignField(foreignFields, options, docs) {
  const projection = parseProjection(get(options, 'select', null), true) ||
    parseProjection(get(options, 'options.select', null), true);

  if (projection == null) {
    return;
***REMOVED***
  for (const foreignField of foreignFields) {
    if (!projection.hasOwnProperty('-' + foreignField)) {
      continue;
***REMOVED***

    for (const val of docs) {
      if (val.$__ != null) {
        mpath.unset(foreignField, val._doc);
  ***REMOVED***
        mpath.unset(foreignField, val);
  ***REMOVED***
***REMOVED***
***REMOVED***
};
